{% extends "../base.html" %}

{% block body %}
  {% if msg %}
    <h4>{{ msg }}</h4>
  {% end %}

  {% if err %}
    {{ err }}</br>
  {% end %}

  {% if form %}
    <h4>Tweet!</h4>
    <form method="POST" action="">

      <label>Choose accounts...</label>
      <select name="chamber">
        <option value="">---</option>
        <option value="all">All FTV accounts</option>
        <option value="senate">All Senators</option>
        <option value="house">All Representatives</option>
      </select>
      </br>

      <label>or type an account name:</label>
      


      <div class="fieldWrapper">
          <textarea name="tweet_text" id="id_tweet_text" rows="4" class="field span8">{{ form['tweet_text'] }}</textarea>
      </div>
      <span id="tweet_counter"></span>
      </br>
      <button type="submit" class="btn btn-primary">Tweet</button>
    </form>
        
  {% end %}

{% end %}

{% block javascript %}
  <script>
    $(document).ready(function() {  
      // Track changes in tweet text box
      tweet_counter();
      $('#id_tweet_text').on('input', function () {
        tweet_counter();
      });

    }); //$(document).ready();

    function tweet_counter() {
      max_length = 140;
      //tweet_beginning = $("#tweet_beginning")
      tweet_beginning = 30; // hardcoded because actual text doesn't match potential length
      tweet_input = $('#id_tweet_text').val();
      char_remaining = max_length - tweet_input.length - tweet_beginning;
      $('#tweet_counter').text(char_remaining + " characters left");
      
      // styling
      if (char_remaining < 0) {
        $('#tweet_counter').css("color", "red");
      }
      else{
        $('#tweet_counter').css("color", "black");
      }
    }
  </script>
{% end %}